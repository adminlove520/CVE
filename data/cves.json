{
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1",
  "cveMetadata": {
    "total_count": 7,
    "last_updated": "2025-12-16T14:13:10.794681",
    "severity_distribution": {
      "critical": 0,
      "high": 0,
      "medium": 0,
      "low": 0,
      "none": 7
    }
  },
  "cves": [
    {
      "id": "CVE-2025-68238",
      "publishedDate": "2025-12-16T14:08:31.672Z",
      "lastModifiedDate": "2025-12-16T14:08:31.672Z",
      "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmtd: rawnand: cadence: fix DMA device NULL pointer dereference\n\nThe DMA device pointer `dma_dev` was being dereferenced before ensuring\nthat `cdns_ctrl->dmac` is properly initialized.\n\nMove the assignment of `dma_dev` after successfully acquiring the DMA\nchannel to ensure the pointer is valid before use.",
      "severity": "N/A",
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/2178b0255eae108bb10e5e99658b28641bc06f43",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/9c58c64ec41290c12490ca7e1df45013fbbb41fd",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/e282a4fdf3c6ee842a720010a8b5f7d77bedd126",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/b146e0b085d9d6bfe838e0a15481cba7d093c67f",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/0c635241a62f2f5da1b48bfffae226d1f86a76ef",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/0c2a43cb43786011b48eeab6093db14888258c6b",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/5c56bf214af85ca042bf97f8584aab2151035840",
          "type": "reference"
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/mtd/nand/raw/cadence-nand-controller.c"
          ],
          "versions": [
            {
              "version": "0cae7c285f4771a9927ef592899234d307aea5d4",
              "lessThan": "2178b0255eae108bb10e5e99658b28641bc06f43",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "099a316518508be7c57de4134ef919b2dea948ce",
              "lessThan": "9c58c64ec41290c12490ca7e1df45013fbbb41fd",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "e630d32162a8aab92d4aaebae0a8d93039257593",
              "lessThan": "e282a4fdf3c6ee842a720010a8b5f7d77bedd126",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "ad9393467fbd788ac2b8a01e492e45ab1b68a1b1",
              "lessThan": "b146e0b085d9d6bfe838e0a15481cba7d093c67f",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "0ce5416863965ddd86e066484a306867cf1e01a8",
              "lessThan": "0c635241a62f2f5da1b48bfffae226d1f86a76ef",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "d76d22b5096c5b05208fd982b153b3f182350b19",
              "lessThan": "0c2a43cb43786011b48eeab6093db14888258c6b",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "d76d22b5096c5b05208fd982b153b3f182350b19",
              "lessThan": "5c56bf214af85ca042bf97f8584aab2151035840",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "a33c7492dcdf804b705b6c21018a481414d48038",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/mtd/nand/raw/cadence-nand-controller.c"
          ],
          "versions": [
            {
              "version": "6.14",
              "status": "affected"
            },
            {
              "version": "0",
              "lessThan": "6.14",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "5.10.247",
              "lessThanOrEqual": "5.10.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "5.15.197",
              "lessThanOrEqual": "5.15.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.1.159",
              "lessThanOrEqual": "6.1.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.6.118",
              "lessThanOrEqual": "6.6.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.12.60",
              "lessThanOrEqual": "6.12.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.17.10",
              "lessThanOrEqual": "6.17.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.18",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "problemType": [],
      "fix_suggestion": "无法生成修复建议"
    },
    {
      "id": "CVE-2025-68237",
      "publishedDate": "2025-12-16T14:08:30.940Z",
      "lastModifiedDate": "2025-12-16T14:08:30.940Z",
      "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmtdchar: fix integer overflow in read/write ioctls\n\nThe \"req.start\" and \"req.len\" variables are u64 values that come from the\nuser at the start of the function.  We mask away the high 32 bits of\n\"req.len\" so that's capped at U32_MAX but the \"req.start\" variable can go\nup to U64_MAX which means that the addition can still integer overflow.\n\nUse check_add_overflow() to fix this bug.",
      "severity": "N/A",
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/f37efdd97fd1ec3e0d0f1eec279c8279e28f981e",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/457376c6fbf0c69326a9bf1f72416225f681192b",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/eb9361484814fb12f3b7544b33835ea67d7a6a97",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/37944f4f8199cd153fef74e95ca268020162f212",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/e4185bed738da755b191aa3f2e16e8b48450e1b8",
          "type": "reference"
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/mtd/mtdchar.c"
          ],
          "versions": [
            {
              "version": "6420ac0af95dbcb2fd8452e2d551ab50e1bbad83",
              "lessThan": "f37efdd97fd1ec3e0d0f1eec279c8279e28f981e",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "6420ac0af95dbcb2fd8452e2d551ab50e1bbad83",
              "lessThan": "457376c6fbf0c69326a9bf1f72416225f681192b",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "6420ac0af95dbcb2fd8452e2d551ab50e1bbad83",
              "lessThan": "eb9361484814fb12f3b7544b33835ea67d7a6a97",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "6420ac0af95dbcb2fd8452e2d551ab50e1bbad83",
              "lessThan": "37944f4f8199cd153fef74e95ca268020162f212",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "6420ac0af95dbcb2fd8452e2d551ab50e1bbad83",
              "lessThan": "e4185bed738da755b191aa3f2e16e8b48450e1b8",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/mtd/mtdchar.c"
          ],
          "versions": [
            {
              "version": "5.17",
              "status": "affected"
            },
            {
              "version": "0",
              "lessThan": "5.17",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.1.159",
              "lessThanOrEqual": "6.1.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.6.118",
              "lessThanOrEqual": "6.6.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.12.60",
              "lessThanOrEqual": "6.12.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.17.10",
              "lessThanOrEqual": "6.17.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.18",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "problemType": [],
      "fix_suggestion": "无法生成修复建议"
    },
    {
      "id": "CVE-2025-68236",
      "publishedDate": "2025-12-16T14:08:30.224Z",
      "lastModifiedDate": "2025-12-16T14:08:30.224Z",
      "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: ufs: ufs-qcom: Fix UFS OCP issue during UFS power down (PC=3)\n\nAccording to UFS specifications, the power-off sequence for a UFS device\nincludes:\n\n - Sending an SSU command with Power_Condition=3 and await a response.\n\n - Asserting RST_N low.\n\n - Turning off REF_CLK.\n\n - Turning off VCC.\n\n - Turning off VCCQ/VCCQ2.\n\nAs part of ufs shutdown, after the SSU command completion, asserting\nhardware reset (HWRST) triggers the device firmware to wake up and\nexecute its reset routine. This routine initializes hardware blocks and\ntakes a few milliseconds to complete. During this time, the ICCQ draws a\nlarge current.\n\nThis large ICCQ current may cause issues for the regulator which is\nsupplying power to UFS, because the turn off request from UFS driver to\nthe regulator framework will be immediately followed by low power\nmode(LPM) request by regulator framework. This is done by framework\nbecause UFS which is the only client is requesting for disable. So if\nthe rail is still in the process of shutting down while ICCQ exceeds LPM\ncurrent thresholds, and LPM mode is activated in hardware during this\nstate, it may trigger an overcurrent protection (OCP) fault in the\nregulator.\n\nTo prevent this, a 10ms delay is added after asserting HWRST. This\nallows the reset operation to complete while power rails remain active\nand in high-power mode.\n\nCurrently there is no way for Host to query whether the reset is\ncompleted or not and hence this the delay is based on experiments with\nQualcomm UFS controllers across multiple UFS vendors.",
      "severity": "N/A",
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/b712f234a74c1f5ce70b5d7aec3fc2499c258141",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/5127be409c6c3815c4a7d8f6d88043e44f9b9543",
          "type": "reference"
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/ufs/host/ufs-qcom.c"
          ],
          "versions": [
            {
              "version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
              "lessThan": "b712f234a74c1f5ce70b5d7aec3fc2499c258141",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
              "lessThan": "5127be409c6c3815c4a7d8f6d88043e44f9b9543",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/ufs/host/ufs-qcom.c"
          ],
          "versions": [
            {
              "version": "6.17.10",
              "lessThanOrEqual": "6.17.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.18",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "problemType": [],
      "fix_suggestion": "无法生成修复建议"
    },
    {
      "id": "CVE-2025-68235",
      "publishedDate": "2025-12-16T14:08:29.396Z",
      "lastModifiedDate": "2025-12-16T14:08:29.396Z",
      "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnouveau/firmware: Add missing kfree() of nvkm_falcon_fw::boot\n\nnvkm_falcon_fw::boot is allocated, but no one frees it. This causes a\nkmemleak warning.\n\nMake sure this data is deallocated.",
      "severity": "N/A",
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/7d1977b4ae5c50e1aafc5c51500fc08bd7afd6a0",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/6492add9a3a163d5e0390428d2636adc3e61b883",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/2bba02a39bfb383bd1a95868d532c0917e38f9e7",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/949f1fd2225baefbea2995afa807dba5cbdb6bd3",
          "type": "reference"
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/gpu/drm/nouveau/nvkm/falcon/fw.c"
          ],
          "versions": [
            {
              "version": "2541626cfb794e57ba0575a6920826f591f7ced0",
              "lessThan": "7d1977b4ae5c50e1aafc5c51500fc08bd7afd6a0",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "2541626cfb794e57ba0575a6920826f591f7ced0",
              "lessThan": "6492add9a3a163d5e0390428d2636adc3e61b883",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "2541626cfb794e57ba0575a6920826f591f7ced0",
              "lessThan": "2bba02a39bfb383bd1a95868d532c0917e38f9e7",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "2541626cfb794e57ba0575a6920826f591f7ced0",
              "lessThan": "949f1fd2225baefbea2995afa807dba5cbdb6bd3",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/gpu/drm/nouveau/nvkm/falcon/fw.c"
          ],
          "versions": [
            {
              "version": "6.2",
              "status": "affected"
            },
            {
              "version": "0",
              "lessThan": "6.2",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.6.118",
              "lessThanOrEqual": "6.6.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.12.60",
              "lessThanOrEqual": "6.12.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.17.10",
              "lessThanOrEqual": "6.17.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.18",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "problemType": [],
      "fix_suggestion": "无法生成修复建议"
    },
    {
      "id": "CVE-2025-68234",
      "publishedDate": "2025-12-16T14:04:14.300Z",
      "lastModifiedDate": "2025-12-16T14:04:14.300Z",
      "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nio_uring/cmd_net: fix wrong argument types for skb_queue_splice()\n\nIf timestamp retriving needs to be retried and the local list of\nSKB's already has entries, then it's spliced back into the socket\nqueue. However, the arguments for the splice helper are transposed,\ncausing exactly the wrong direction of splicing into the on-stack\nlist. Fix that up.",
      "severity": "N/A",
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/c85d2cfc5e24e6866b56c7253fd4e1c7db35986c",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/46447367a52965e9d35f112f5b26fc8ff8ec443d",
          "type": "reference"
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "io_uring/cmd_net.c"
          ],
          "versions": [
            {
              "version": "9e4ed359b8efad0e8ad4510d8ad22bf0b060526a",
              "lessThan": "c85d2cfc5e24e6866b56c7253fd4e1c7db35986c",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "9e4ed359b8efad0e8ad4510d8ad22bf0b060526a",
              "lessThan": "46447367a52965e9d35f112f5b26fc8ff8ec443d",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "io_uring/cmd_net.c"
          ],
          "versions": [
            {
              "version": "6.17",
              "status": "affected"
            },
            {
              "version": "0",
              "lessThan": "6.17",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.17.10",
              "lessThanOrEqual": "6.17.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.18",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "problemType": [],
      "fix_suggestion": "无法生成修复建议"
    },
    {
      "id": "CVE-2025-68233",
      "publishedDate": "2025-12-16T14:04:13.490Z",
      "lastModifiedDate": "2025-12-16T14:04:13.490Z",
      "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/tegra: Add call to put_pid()\n\nAdd a call to put_pid() corresponding to get_task_pid().\nhost1x_memory_context_alloc() does not take ownership of the PID so we\nneed to free it here to avoid leaking.\n\n[mperttunen@nvidia.com: reword commit message]",
      "severity": "N/A",
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/6b572e5154af08ee13f8d2673e86f83bc5ff86cd",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/2e78580e6e7deac6556236ef96db5bbf7b46857e",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/cbf2cbdb0733d7974dab296ffba0e7ae9b6524e5",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/27ea5c2c75c3419a9a019240ca44b9256f628df1",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/6cbab9f0da72b4dc3c3f9161197aa3b9daa1fa3a",
          "type": "reference"
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/gpu/drm/tegra/uapi.c"
          ],
          "versions": [
            {
              "version": "e09db97889ec647ad373f7a7422c83099c6120c5",
              "lessThan": "6b572e5154af08ee13f8d2673e86f83bc5ff86cd",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "e09db97889ec647ad373f7a7422c83099c6120c5",
              "lessThan": "2e78580e6e7deac6556236ef96db5bbf7b46857e",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "e09db97889ec647ad373f7a7422c83099c6120c5",
              "lessThan": "cbf2cbdb0733d7974dab296ffba0e7ae9b6524e5",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "e09db97889ec647ad373f7a7422c83099c6120c5",
              "lessThan": "27ea5c2c75c3419a9a019240ca44b9256f628df1",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "e09db97889ec647ad373f7a7422c83099c6120c5",
              "lessThan": "6cbab9f0da72b4dc3c3f9161197aa3b9daa1fa3a",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/gpu/drm/tegra/uapi.c"
          ],
          "versions": [
            {
              "version": "6.0",
              "status": "affected"
            },
            {
              "version": "0",
              "lessThan": "6.0",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.1.159",
              "lessThanOrEqual": "6.1.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.6.118",
              "lessThanOrEqual": "6.6.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.12.60",
              "lessThanOrEqual": "6.12.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.17.10",
              "lessThanOrEqual": "6.17.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.18",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "problemType": [],
      "fix_suggestion": "无法生成修复建议"
    },
    {
      "id": "CVE-2025-68232",
      "publishedDate": "2025-12-16T14:04:12.624Z",
      "lastModifiedDate": "2025-12-16T14:04:12.624Z",
      "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nveth: more robust handing of race to avoid txq getting stuck\n\nCommit dc82a33297fc (\"veth: apply qdisc backpressure on full ptr_ring to\nreduce TX drops\") introduced a race condition that can lead to a permanently\nstalled TXQ. This was observed in production on ARM64 systems (Ampere Altra\nMax).\n\nThe race occurs in veth_xmit(). The producer observes a full ptr_ring and\nstops the queue (netif_tx_stop_queue()). The subsequent conditional logic,\nintended to re-wake the queue if the consumer had just emptied it (if\n(__ptr_ring_empty(...)) netif_tx_wake_queue()), can fail. This leads to a\n\"lost wakeup\" where the TXQ remains stopped (QUEUE_STATE_DRV_XOFF) and\ntraffic halts.\n\nThis failure is caused by an incorrect use of the __ptr_ring_empty() API\nfrom the producer side. As noted in kernel comments, this check is not\nguaranteed to be correct if a consumer is operating on another CPU. The\nempty test is based on ptr_ring->consumer_head, making it reliable only for\nthe consumer. Using this check from the producer side is fundamentally racy.\n\nThis patch fixes the race by adopting the more robust logic from an earlier\nversion V4 of the patchset, which always flushed the peer:\n\n(1) In veth_xmit(), the racy conditional wake-up logic and its memory barrier\nare removed. Instead, after stopping the queue, we unconditionally call\n__veth_xdp_flush(rq). This guarantees that the NAPI consumer is scheduled,\nmaking it solely responsible for re-waking the TXQ.\n  This handles the race where veth_poll() consumes all packets and completes\nNAPI *before* veth_xmit() on the producer side has called netif_tx_stop_queue.\nThe __veth_xdp_flush(rq) will observe rx_notify_masked is false and schedule\nNAPI.\n\n(2) On the consumer side, the logic for waking the peer TXQ is moved out of\nveth_xdp_rcv() and placed at the end of the veth_poll() function. This\nplacement is part of fixing the race, as the netif_tx_queue_stopped() check\nmust occur after rx_notify_masked is potentially set to false during NAPI\ncompletion.\n  This handles the race where veth_poll() consumes all packets, but haven't\nfinished (rx_notify_masked is still true). The producer veth_xmit() stops the\nTXQ and __veth_xdp_flush(rq) will observe rx_notify_masked is true, meaning\nnot starting NAPI.  Then veth_poll() change rx_notify_masked to false and\nstops NAPI.  Before exiting veth_poll() will observe TXQ is stopped and wake\nit up.",
      "severity": "N/A",
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/dd419a3f2ebc18cc00bc32c57fd052d7a188b78b",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/6c8a8b9257a660e622689e23c8fbad4ba2b561b9",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/5442a9da69789741bfda39f34ee7f69552bf0c56",
          "type": "reference"
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/net/veth.c"
          ],
          "versions": [
            {
              "version": "9fe31b3f314534e238aa6d0b6fb492134cbcf8be",
              "lessThan": "dd419a3f2ebc18cc00bc32c57fd052d7a188b78b",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "dc82a33297fc2c58cb0b2b008d728668d45c0f6a",
              "lessThan": "6c8a8b9257a660e622689e23c8fbad4ba2b561b9",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "dc82a33297fc2c58cb0b2b008d728668d45c0f6a",
              "lessThan": "5442a9da69789741bfda39f34ee7f69552bf0c56",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "drivers/net/veth.c"
          ],
          "versions": [
            {
              "version": "6.16",
              "status": "affected"
            },
            {
              "version": "0",
              "lessThan": "6.16",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.17.10",
              "lessThanOrEqual": "6.17.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.18",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "problemType": [],
      "fix_suggestion": "无法生成修复建议"
    }
  ]
}