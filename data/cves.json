{
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1",
  "cveMetadata": {
    "total_count": 2,
    "last_updated": "2025-06-28T07:51:08.166860",
    "severity_distribution": {
      "critical": 0,
      "high": 0,
      "medium": 0,
      "low": 0,
      "none": 2
    }
  },
  "cves": [
    {
      "id": "CVE-2025-38085",
      "publishedDate": "2025-06-28T07:44:26.178Z",
      "lastModifiedDate": "2025-06-28T07:44:26.178Z",
      "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/hugetlb: fix huge_pmd_unshare() vs GUP-fast race\n\nhuge_pmd_unshare() drops a reference on a page table that may have\npreviously been shared across processes, potentially turning it into a\nnormal page table used in another process in which unrelated VMAs can\nafterwards be installed.\n\nIf this happens in the middle of a concurrent gup_fast(), gup_fast() could\nend up walking the page tables of another process.  While I don't see any\nway in which that immediately leads to kernel memory corruption, it is\nreally weird and unexpected.\n\nFix it with an explicit broadcast IPI through tlb_remove_table_sync_one(),\njust like we do in khugepaged when removing page tables for a THP\ncollapse.",
      "severity": "N/A",
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/952596b08c74e8fe9e2883d1dc8a8f54a37384ec",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/a3d864c901a300c295692d129159fc3001a56185",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/b7754d3aa7bf9f62218d096c0c8f6c13698fac8b",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/fe684290418ef9ef76630072086ee530b92f02b8",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/034a52b5ef57c9c8225d94e9067f3390bb33922f",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/a6bfeb97941a9187833b526bc6cc4ff5706d0ce9",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/1013af4f585fccc4d3e5c5824d174de2257f7d6d",
          "type": "reference"
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "mm/hugetlb.c"
          ],
          "versions": [
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "952596b08c74e8fe9e2883d1dc8a8f54a37384ec",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "a3d864c901a300c295692d129159fc3001a56185",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "b7754d3aa7bf9f62218d096c0c8f6c13698fac8b",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "fe684290418ef9ef76630072086ee530b92f02b8",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "034a52b5ef57c9c8225d94e9067f3390bb33922f",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "a6bfeb97941a9187833b526bc6cc4ff5706d0ce9",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "1013af4f585fccc4d3e5c5824d174de2257f7d6d",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "mm/hugetlb.c"
          ],
          "versions": [
            {
              "version": "2.6.20",
              "status": "affected"
            },
            {
              "version": "0",
              "lessThan": "2.6.20",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "5.10.239",
              "lessThanOrEqual": "5.10.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "5.15.186",
              "lessThanOrEqual": "5.15.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.1.142",
              "lessThanOrEqual": "6.1.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.6.95",
              "lessThanOrEqual": "6.6.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.12.35",
              "lessThanOrEqual": "6.12.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.15.4",
              "lessThanOrEqual": "6.15.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.16-rc1",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "problemType": [],
      "fix_suggestion": "无法生成修复建议"
    },
    {
      "id": "CVE-2025-38084",
      "publishedDate": "2025-06-28T07:44:25.379Z",
      "lastModifiedDate": "2025-06-28T07:44:25.379Z",
      "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/hugetlb: unshare page tables during VMA split, not before\n\nCurrently, __split_vma() triggers hugetlb page table unsharing through\nvm_ops->may_split().  This happens before the VMA lock and rmap locks are\ntaken - which is too early, it allows racing VMA-locked page faults in our\nprocess and racing rmap walks from other processes to cause page tables to\nbe shared again before we actually perform the split.\n\nFix it by explicitly calling into the hugetlb unshare logic from\n__split_vma() in the same place where THP splitting also happens.  At that\npoint, both the VMA and the rmap(s) are write-locked.\n\nAn annoying detail is that we can now call into the helper\nhugetlb_unshare_pmds() from two different locking contexts:\n\n1. from hugetlb_split(), holding:\n    - mmap lock (exclusively)\n    - VMA lock\n    - file rmap lock (exclusively)\n2. hugetlb_unshare_all_pmds(), which I think is designed to be able to\n   call us with only the mmap lock held (in shared mode), but currently\n   only runs while holding mmap lock (exclusively) and VMA lock\n\nBackporting note:\nThis commit fixes a racy protection that was introduced in commit\nb30c14cd6102 (\"hugetlb: unshare some PMDs when splitting VMAs\"); that\ncommit claimed to fix an issue introduced in 5.13, but it should actually\nalso go all the way back.\n\n[jannh@google.com: v2]",
      "severity": "N/A",
      "references": [
        {
          "url": "https://git.kernel.org/stable/c/e8847d18cd9fff1edbb45e963d9141273c3b539c",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/366298f2b04d2bf1f2f2b7078405bdf9df9bd5d0",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/2511ac64bc1617ca716d3ba8464e481a647c1902",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/af6cfcd0efb7f051af221c418ec8b37a10211947",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/9cf5b2a3b72c23fb7b84736d5d19ee6ea718762b",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/8a21d5584826f4880f45bbf8f72375f4e6c0ff2a",
          "type": "reference"
        },
        {
          "url": "https://git.kernel.org/stable/c/081056dc00a27bccb55ccc3c6f230a3d5fd3f7e0",
          "type": "reference"
        }
      ],
      "affected": [
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "unaffected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "include/linux/hugetlb.h",
            "mm/hugetlb.c",
            "mm/vma.c",
            "tools/testing/vma/vma_internal.h"
          ],
          "versions": [
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "e8847d18cd9fff1edbb45e963d9141273c3b539c",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "366298f2b04d2bf1f2f2b7078405bdf9df9bd5d0",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "2511ac64bc1617ca716d3ba8464e481a647c1902",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "af6cfcd0efb7f051af221c418ec8b37a10211947",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "9cf5b2a3b72c23fb7b84736d5d19ee6ea718762b",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "8a21d5584826f4880f45bbf8f72375f4e6c0ff2a",
              "status": "affected",
              "versionType": "git"
            },
            {
              "version": "39dde65c9940c97fcd178a3d2b1c57ed8b7b68aa",
              "lessThan": "081056dc00a27bccb55ccc3c6f230a3d5fd3f7e0",
              "status": "affected",
              "versionType": "git"
            }
          ]
        },
        {
          "product": "Linux",
          "vendor": "Linux",
          "defaultStatus": "affected",
          "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
          "programFiles": [
            "include/linux/hugetlb.h",
            "mm/hugetlb.c",
            "mm/vma.c",
            "tools/testing/vma/vma_internal.h"
          ],
          "versions": [
            {
              "version": "2.6.20",
              "status": "affected"
            },
            {
              "version": "0",
              "lessThan": "2.6.20",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "5.10.239",
              "lessThanOrEqual": "5.10.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "5.15.186",
              "lessThanOrEqual": "5.15.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.1.142",
              "lessThanOrEqual": "6.1.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.6.95",
              "lessThanOrEqual": "6.6.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.12.35",
              "lessThanOrEqual": "6.12.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.15.4",
              "lessThanOrEqual": "6.15.*",
              "status": "unaffected",
              "versionType": "semver"
            },
            {
              "version": "6.16-rc1",
              "lessThanOrEqual": "*",
              "status": "unaffected",
              "versionType": "original_commit_for_fix"
            }
          ]
        }
      ],
      "problemType": [],
      "fix_suggestion": "无法生成修复建议"
    }
  ]
}